<?php

/*  This is a simple php script to show how to use the xml page generated by the
    StatusServer to display server stats in PHP4.  It's much easier in PHP5 and
    does not require the external class.  However, we work with the server we have.
*/

require("simplexml.class.php");

$serverAddress = "85.21.108.23";
$port = 44455;

$fp = @fsockopen("tcp://" . $serverAddress, $port, $errno, $errstr);
if (!$fp) {
    $status = "down";
}
else
{
    fwrite($fp, "\n");
    $xml = fread($fp, 99999);
    fclose($fp);
    
    $sxml = new simplexml;
    $xmldata = $sxml->xml_load_data($xml);
    $status = $xmldata->status;
}

if ($status == "down") {
    echo "Status: $status<br/>";
    exit(1);
}
print $status;

echo "Status: ".$status."<br />";
echo "Server Name: ".$xmldata->name."<br />";
echo "Users Connected: " . $xmldata->users->connected . "<br/>";
echo "Max Users: " . $xmldata->users->max . "<br/>";
echo "Last Checked: " . date("F j, Y, g:i:s a", $xmldata->timestamp);

?>
